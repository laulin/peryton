{
    # Global options block
    log {
        output file /var/log/caddy/access.log {
            roll_size 100mb
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
        level INFO
    }
}



doc.cyber {
    log {
        output file /var/log/caddy/doc.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

    tls /certs/wildcard.cyber.crt /certs/wildcard.cyber.key {
        protocols tls1.3
    }

    reverse_proxy 172.20.0.50:3000
    
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
        Referrer-Policy "no-referrer"
        Permissions-Policy "geolocation=(), microphone=()"
        -Server
    }
}

homepage.cyber {

    log {
        output file /var/log/caddy/homepage.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

    tls /certs/wildcard.cyber.crt /certs/wildcard.cyber.key {
        protocols tls1.3
    }

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
        Referrer-Policy "no-referrer"
        Permissions-Policy "geolocation=(), microphone=()"
        -Server
    }

    reverse_proxy 172.20.0.10:3000
}

vpn.cyber {

    log {
        output file /var/log/caddy/vpn.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
        Referrer-Policy "no-referrer"
        Permissions-Policy "geolocation=(), microphone=()"
        -Server
    }

    tls /certs/wildcard.cyber.crt /certs/wildcard.cyber.key {
        protocols tls1.3
    }

    reverse_proxy 172.19.0.30:51821

}

gogs.cyber {

    log {
        output file /var/log/caddy/gogs.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
        Referrer-Policy "no-referrer"
        Permissions-Policy "geolocation=(), microphone=()"
        -Server
    }

    tls /certs/wildcard.cyber.crt /certs/wildcard.cyber.key {
        protocols tls1.3
    }

    reverse_proxy 172.20.0.40:3000

}

pihole.cyber {

    log {
        output file /var/log/caddy/pihole.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
        Referrer-Policy "no-referrer"
        Permissions-Policy "geolocation=(), microphone=()"
        -Server
    }

    tls /certs/wildcard.cyber.crt /certs/wildcard.cyber.key {
        protocols tls1.3
    }

    reverse_proxy 172.19.0.10:80

}

crl.cyber {

    log {
        output file /var/log/caddy/crl.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

	root * /crl
	file_server browse

}

ressources.cyber {

    log {
        output file /var/log/caddy/crl.access.log {
            roll_size 10MiB
            roll_keep 5
            roll_keep_for 240h
            roll_uncompressed
        }
    }

	root * /ressources
	file_server browse

}